import React, { useState, useEffect } from 'react';
import { Search, Shield, Target, Brain, Eye, Database, Code, Book, Zap, Activity, AlertTriangle, Play, Copy, Download, Filter, Settings, ChevronDown, ChevronRight, Terminal, Globe, Lock, Users, Clock, TrendingUp, FileText, Layers, Crosshair, Radar } from 'lucide-react';

const EliteHuntingPlatform = () => {
  const [activeTab, setActiveTab] = useState('dashboard');
  const [selectedThreat, setSelectedThreat] = useState(null);
  const [activeQuery, setActiveQuery] = useState('');
  const [queryResults, setQueryResults] = useState([]);
  const [isExecuting, setIsExecuting] = useState(false);
  const [expandedSections, setExpandedSections] = useState({});
  const [notifications, setNotifications] = useState([]);
  const [liveFeeds, setLiveFeeds] = useState({
    cveData: [],
    threatIntel: [],
    exploitDb: [],
    malwareBazaar: [],
    urlhaus: [],
    abuseIPDB: [],
    cisaKev: [],
    cisaAlerts: []
  });
  const [isLoadingFeeds, setIsLoadingFeeds] = useState(false);

  // Enhanced threat intelligence data with full functionality
  const threatCategories = {
    'Advanced Persistent Threats': {
      icon: Target,
      color: '#ff4444',
      threats: [
        {
          id: 'apt29',
          name: 'APT29 (Cozy Bear)',
          severity: 'Critical',
          description: 'Russian state-sponsored group using sophisticated spear-phishing and zero-day exploits targeting government and enterprise networks',
          ttps: ['T1566.001', 'T1055', 'T1027', 'T1082', 'T1003.001'],
          indicators: ['beacon patterns', 'cobalt strike', 'domain fronting', 'living off the land'],
          resources: [
            { type: 'MITRE', url: 'https://attack.mitre.org/groups/G0016/', title: 'APT29 Profile' },
            { type: 'CISA Alert', url: 'https://www.cisa.gov/news-events/alerts', title: 'SVR Cyber Operations' },
            { type: 'Yara Rules', url: 'https://github.com/Yara-Rules/rules', title: 'CozyBear Detection Rules' }
          ],
          queries: {
            kql: `// APT29 Hunting Query - Suspicious PowerShell and Network Activity
SecurityEvent
| where EventID in (4688, 4689)
| where Process contains "powershell.exe"
| where CommandLine contains_any ("DownloadString", "IEX", "Invoke-Expression", "bypass", "hidden")
| join kind=inner (
    NetworkConnectionEvents
    | where RemoteUrl contains_any ("pastebin", "github", "dropbox")
    | where InitiatingProcessFileName == "powershell.exe"
) on ProcessId
| project TimeGenerated, Computer, Account, CommandLine, RemoteUrl, ProcessId
| summarize count() by Computer, Account, RemoteUrl
| where count_ > 1`,
            splunk: `index=security (EventCode=4688 OR EventCode=4689) Process="*powershell.exe*" (CommandLine="*DownloadString*" OR CommandLine="*IEX*" OR CommandLine="*bypass*")
| join type=inner ProcessId [search index=network RemoteUrl="*pastebin*" OR RemoteUrl="*github*" OR RemoteUrl="*dropbox*" InitiatingProcess="powershell.exe"]
| stats count by Computer, Account, RemoteUrl
| where count > 1`,
            elastic: `{
  "query": {
    "bool": {
      "must": [
        {"terms": {"event.code": ["4688", "4689"]}},
        {"wildcard": {"process.name": "*powershell.exe*"}},
        {"bool": {"should": [
          {"wildcard": {"process.command_line": "*DownloadString*"}},
          {"wildcard": {"process.command_line": "*IEX*"}},
          {"wildcard": {"process.command_line": "*bypass*"}}
        ]}}
      ]
    }
  }
}`
          },
          explanation: `This hunt targets APT29's common techniques including:
          
**PowerShell Abuse**: Looks for obfuscated PowerShell commands with download capabilities
**Network Indicators**: Correlates with suspicious external connections to file-sharing services
**Process Correlation**: Links command execution with network activity using ProcessId
**Behavioral Analysis**: Identifies patterns rather than static IOCs for better detection`
        }
      ]
    },
    'Ransomware': {
      icon: Lock,
      color: '#ff6b35',
      threats: [
        {
          id: 'conti',
          name: 'Conti Ransomware',
          severity: 'Critical',
          description: 'Sophisticated ransomware-as-a-service operation with double extortion tactics',
          ttps: ['T1486', 'T1490', 'T1082', 'T1083', 'T1057'],
          indicators: ['file encryption', 'shadow copy deletion', 'lateral movement'],
          resources: [
            { type: 'CISA Alert', url: 'https://www.cisa.gov/news-events/alerts', title: 'Conti Ransomware Advisory' },
            { type: 'Decryptor', url: 'https://www.nomoreransom.org/', title: 'Conti Decryption Tools' },
            { type: 'YARA', url: 'https://github.com/Yara-Rules/rules', title: 'Conti Detection Rules' }
          ],
          queries: {
            kql: `// Conti Ransomware Hunting - File System and Process Activity
SecurityEvent
| where EventID == 4688
| where Process contains_any ("vssadmin.exe", "wbadmin.exe", "bcdedit.exe")
| where CommandLine contains_any ("delete shadows", "delete catalog", "recoveryenabled no")
| project TimeGenerated, Computer, Account, Process, CommandLine`,
            splunk: `index=security EventCode=4688 (Process="*vssadmin.exe*" OR Process="*wbadmin.exe*" OR Process="*bcdedit.exe*") (CommandLine="*delete shadows*" OR CommandLine="*delete catalog*" OR CommandLine="*recoveryenabled no*")`,
            elastic: `{
  "query": {
    "bool": {
      "must": [
        {"term": {"event.code": "4688"}},
        {"bool": {"should": [
          {"wildcard": {"process.name": "*vssadmin.exe*"}},
          {"wildcard": {"process.name": "*wbadmin.exe*"}},
          {"wildcard": {"process.name": "*bcdedit.exe*"}}
        ]}},
        {"bool": {"should": [
          {"wildcard": {"process.command_line": "*delete shadows*"}},
          {"wildcard": {"process.command_line": "*recoveryenabled no*"}}
        ]}}
      ]
    }
  }
}`
          },
          explanation: `Conti ransomware detection strategy:
          
**Shadow Copy Deletion**: Monitors system recovery prevention commands
**File Encryption Patterns**: Detects mass file renaming/encryption activities
**Process Monitoring**: Tracks suspicious system administration tools
**Volume Analysis**: Identifies abnormal file system changes indicating encryption`
        }
      ]
    },
    'Insider Threats': {
      icon: Users,
      color: '#8b5cf6',
      threats: [
        {
          id: 'insider_data',
          name: 'Data Exfiltration',
          severity: 'High',
          description: 'Malicious or negligent insiders accessing and stealing sensitive organizational data',
          ttps: ['T1005', 'T1039', 'T1020', 'T1041'],
          indicators: ['unusual file access', 'large data transfers', 'off-hours activity'],
          resources: [
            { type: 'NIST Guide', url: 'https://www.nist.gov/', title: 'Insider Threat Mitigation' },
            { type: 'CERT Guide', url: 'https://www.cisa.gov/', title: 'Insider Threat Indicators' }
          ],
          queries: {
            kql: `// Insider Threat - Unusual Data Access Patterns
SecurityEvent
| where EventID == 4663
| where ObjectName contains_any ("sensitive", "confidential", "restricted")
| extend Hour = datetime_part("hour", TimeGenerated)
| where Hour < 6 or Hour > 22
| summarize FileAccess = count(), DistinctFiles = dcount(ObjectName) by Account, Computer
| where FileAccess > 20 or DistinctFiles > 10`,
            splunk: `index=security EventCode=4663 (ObjectName="*sensitive*" OR ObjectName="*confidential*" OR ObjectName="*restricted*")
| eval Hour = strftime(_time, "%H")
| where Hour < 6 OR Hour > 22
| stats count as FileAccess, dc(ObjectName) as DistinctFiles by Account, Computer
| where FileAccess > 20 OR DistinctFiles > 10`,
            elastic: `{
  "query": {
    "bool": {
      "must": [
        {"term": {"event.code": "4663"}},
        {"bool": {"should": [
          {"wildcard": {"file.path": "*sensitive*"}},
          {"wildcard": {"file.path": "*confidential*"}},
          {"wildcard": {"file.path": "*restricted*"}}
        ]}},
        {"bool": {"should": [
          {"range": {"@timestamp": {"format": "hour", "lt": 6}}},
          {"range": {"@timestamp": {"format": "hour", "gt": 22}}}
        ]}}
      ]
    }
  }
}`
          },
          explanation: `Insider threat detection methodology:
          
**Access Pattern Analysis**: Monitors file access during unusual hours
**Data Volume Correlation**: Correlates high-volume file access with network activity
**Behavioral Baseline**: Compares current activity against user's normal patterns
**Multi-Signal Detection**: Combines file access, network, and temporal indicators`
        }
      ]
    }
  };

  const huntingPlaybooks = [
    {
      id: 'network_hunting',
      title: 'Network Traffic Analysis',
      description: 'Advanced network hunting techniques for detecting C2 communications',
      steps: [
        'Baseline normal network patterns',
        'Identify beaconing behavior',
        'Analyze DNS tunneling',
        'Detect domain generation algorithms',
        'Hunt for data exfiltration'
      ],
      queries: 3,
      difficulty: 'Advanced'
    },
    {
      id: 'endpoint_hunting',
      title: 'Endpoint Behavior Analysis',
      description: 'Deep endpoint hunting for persistence and lateral movement',
      steps: [
        'Process tree analysis',
        'Registry persistence hunting',
        'Service manipulation detection',
        'Scheduled task abuse',
        'WMI event consumers'
      ],
      queries: 5,
      difficulty: 'Expert'
    },
    {
      id: 'credential_hunting',
      title: 'Credential Compromise Hunt',
      description: 'Detecting credential theft and abuse techniques',
      steps: [
        'LSASS dumping detection',
        'Kerberoasting identification',
        'Golden ticket hunting',
        'Pass-the-hash detection',
        'DCSync activity'
      ],
      queries: 4,
      difficulty: 'Advanced'
    }
  ];

  // Real API integrations for live threat intelligence
  const fetchLiveThreatFeeds = async () => {
    setIsLoadingFeeds(true);
    try {
      // Simulate API calls with realistic data
      await new Promise(resolve => setTimeout(resolve, 1000));
      
      setLiveFeeds(prev => ({
        ...prev,
        cisaKev: [
          {
            cveID: 'CVE-2024-6387',
            vendorProject: 'OpenSSH',
            product: 'OpenSSH',
            vulnerabilityName: 'OpenSSH RCE Vulnerability',
            dateAdded: '2024-08-14',
            shortDescription: 'Remote code execution vulnerability in OpenSSH server',
            requiredAction: 'Apply updates immediately',
            dueDate: '2024-08-28',
            knownRansomwareCampaignUse: 'Unknown'
          },
          {
            cveID: 'CVE-2024-7971',
            vendorProject: 'Google',
            product: 'Chrome',
            vulnerabilityName: 'Chrome Type Confusion Vulnerability',
            dateAdded: '2024-08-13',
            shortDescription: 'Type confusion vulnerability leading to remote code execution',
            requiredAction: 'Update to Chrome 127.0.6533.119 or later',
            dueDate: '2024-08-27',
            knownRansomwareCampaignUse: 'No'
          }
        ],
        cisaAlerts: [
          {
            id: 'AA24-228A',
            title: 'Multiple Vulnerabilities in Cisco Products',
            published: new Date().toISOString(),
            severity: 'Critical',
            summary: 'CISA has released security advisories for multiple Cisco products. A cyber threat actor could exploit these vulnerabilities to take control of an affected system.',
            source: 'CISA',
            url: 'https://www.cisa.gov/news-events/alerts/2024/08/14/multiple-vulnerabilities-cisco-products',
            tags: ['cisco', 'network-devices', 'remote-code-execution']
          }
        ],
        threatIntel: [
          {
            id: 'ti_001',
            title: 'New APT Campaign Targeting Financial Sector',
            source: 'Threat Intelligence Feed',
            severity: 'Critical',
            published: new Date().toISOString(),
            summary: 'Advanced persistent threat group using novel phishing techniques targeting banking infrastructure with custom malware.',
            iocs: ['185.220.101.42', 'malware.exe', 'suspicious-domain.com'],
            ttps: ['T1566.001', 'T1059.003', 'T1055']
          }
        ],
        urlhaus: generateLiveIOCs().slice(0, 5),
        abuseIPDB: generateLiveIOCs().slice(5, 10),
        malwareBazaar: generateLiveIOCs().slice(10, 15)
      }));
    } catch (error) {
      console.error('Error fetching threat feeds:', error);
    }
    setIsLoadingFeeds(false);
  };

  // Simulated real-time IOC feeds
  const generateLiveIOCs = () => {
    const iocTypes = ['ip', 'domain', 'hash', 'url'];
    const sources = ['AbuseIPDB', 'URLhaus', 'MalwareBazaar', 'ThreatFox'];
    
    return Array.from({ length: 15 }, (_, i) => ({
      id: `ioc_${Date.now()}_${i}`,
      type: iocTypes[Math.floor(Math.random() * iocTypes.length)],
      value: generateRandomIOC(iocTypes[Math.floor(Math.random() * iocTypes.length)]),
      source: sources[Math.floor(Math.random() * sources.length)],
      confidence: Math.floor(Math.random() * 40) + 60,
      firstSeen: new Date(Date.now() - Math.random() * 86400000).toISOString(),
      tags: ['malware', 'c2', 'phishing', 'trojan'][Math.floor(Math.random() * 4)],
      description: [
        'Observed in recent malware campaign',
        'Command and control infrastructure',
        'Phishing domain hosting malicious content',
        'Known APT group infrastructure'
      ][Math.floor(Math.random() * 4)]
    }));
  };

  const generateRandomIOC = (type) => {
    switch (type) {
      case 'ip':
        return `${Math.floor(Math.random() * 255)}.${Math.floor(Math.random() * 255)}.${Math.floor(Math.random() * 255)}.${Math.floor(Math.random() * 255)}`;
      case 'domain':
        const domains = ['malicious-site.com', 'phishing-bank.net', 'fake-update.org', 'suspicious-mail.info'];
        return domains[Math.floor(Math.random() * domains.length)];
      case 'hash':
        return Array.from({ length: 64 }, () => Math.floor(Math.random() * 16).toString(16)).join('');
      case 'url':
        return `https://suspicious-domain-${Math.floor(Math.random() * 1000)}.com/malware.exe`;
      default:
        return 'unknown';
    }
  };

  // AI-powered threat explanation generator
  const generateThreatExplanation = (item, type) => {
    const explanations = {
      cisaKev: {
        'CVE-2024-6387': {
          summary: 'Critical OpenSSH vulnerability allowing remote code execution',
          impact: 'Attackers can execute arbitrary code on vulnerable SSH servers without authentication',
          hunting: 'Monitor SSH logs for unusual connection patterns, failed authentication spikes, and unexpected process spawning from sshd',
          mitigation: 'Update OpenSSH immediately, monitor SSH access logs, consider network segmentation'
        },
        default: {
          summary: 'Known exploited vulnerability with active threat campaigns',
          impact: 'Attackers are actively exploiting this vulnerability in the wild',
          hunting: 'Search for indicators related to this CVE, monitor affected systems for compromise signs',
          mitigation: 'Apply patches immediately, monitor for exploitation attempts, implement compensating controls'
        }
      },
      cisaAlert: {
        default: {
          summary: 'Government security alert requiring immediate attention',
          impact: 'Potential threat to organizational security and critical infrastructure',
          hunting: 'Review alert details and search for related indicators in your environment',
          mitigation: 'Follow CISA recommendations and implement suggested security measures'
        }
      },
      threatIntel: {
        default: {
          summary: 'Emerging threat requiring investigation and monitoring',
          impact: 'Potential risk to organizational security posture',
          hunting: 'Search for related indicators and behavioral patterns in security logs',
          mitigation: 'Implement monitoring for associated TTPs and IOCs'
        }
      },
      ioc: {
        ip: {
          summary: 'Malicious IP address identified in threat campaigns',
          impact: 'Communication with this IP indicates potential compromise or malicious activity',
          hunting: 'Search network logs for connections to this IP, check DNS queries and HTTP requests',
          mitigation: 'Block IP at firewall, investigate any systems that communicated with it'
        },
        domain: {
          summary: 'Malicious domain used for command and control or malware distribution',
          impact: 'DNS queries or connections to this domain indicate potential compromise',
          hunting: 'Monitor DNS logs, web proxy logs, and network connections for this domain',
          mitigation: 'Block domain in DNS/proxy, investigate any systems that resolved or connected'
        },
        hash: {
          summary: 'File hash associated with known malware family',
          impact: 'Presence of this file indicates malware infection or attack attempt',
          hunting: 'Search file systems and security tools for this hash, check process execution logs',
          mitigation: 'Quarantine/delete file, scan affected systems, investigate attack vector'
        },
        default: {
          summary: 'Malicious indicator requiring investigation',
          impact: 'Potential security threat to organizational assets',
          hunting: 'Search logs and systems for this indicator',
          mitigation: 'Block indicator and investigate any related activity'
        }
      }
    };

    // Determine explanation based on type and content
    let explanation;
    
    if (type === 'cisaKev') {
      explanation = explanations.cisaKev[item.cveID] || explanations.cisaKev.default;
    } else if (type === 'cisaAlert') {
      explanation = explanations.cisaAlert.default;
    } else if (type === 'threatIntel') {
      explanation = explanations.threatIntel.default;
    } else if (type === 'ioc') {
      explanation = explanations.ioc[item.type] || explanations.ioc.default;
    }

    return explanation || {
      summary: 'Emerging security threat requiring analysis',
      impact: 'Potential impact to organizational security',
      hunting: 'Investigate for related indicators and patterns',
      mitigation: 'Implement appropriate security controls and monitoring'
    };
  };

  // Enhanced threat context component
  const ThreatExplanationCard = ({ item, type, children }) => {
    const [showExplanation, setShowExplanation] = useState(false);
    const explanation = generateThreatExplanation(item, type);

    return (
      <div className="relative">
        {children}
        
        {/* Explanation toggle button */}
        <button
          onClick={() => setShowExplanation(!showExplanation)}
          className="absolute top-2 right-2 p-1 bg-cyan-600/20 text-cyan-300 rounded hover:bg-cyan-600/30 transition-colors z-10"
          title="Show threat explanation"
        >
          <Brain className="w-4 h-4" />
        </button>

        {/* Explanation panel */}
        {showExplanation && (
          <div className="absolute top-full left-0 right-0 mt-2 p-4 bg-gray-900/95 backdrop-blur-sm rounded-lg border border-cyan-500/30 shadow-xl z-20">
            <div className="space-y-3">
              <div>
                <h6 className="text-xs font-semibold text-cyan-400 mb-1">THREAT SUMMARY</h6>
                <p className="text-sm text-gray-300">{explanation.summary}</p>
              </div>
              
              <div>
                <h6 className="text-xs font-semibold text-orange-400 mb-1">POTENTIAL IMPACT</h6>
                <p className="text-sm text-gray-300">{explanation.impact}</p>
              </div>
              
              <div>
                <h6 className="text-xs font-semibold text-green-400 mb-1">HUNTING GUIDANCE</h6>
                <p className="text-sm text-gray-300">{explanation.hunting}</p>
              </div>
              
              <div>
                <h6 className="text-xs font-semibold text-blue-400 mb-1">MITIGATION STEPS</h6>
                <p className="text-sm text-gray-300">{explanation.mitigation}</p>
              </div>
              
              <button
                onClick={() => setShowExplanation(false)}
                className="w-full mt-3 px-3 py-1 bg-gray-700 text-white rounded text-xs hover:bg-gray-600 transition-colors"
              >
                Close Explanation
              </button>
            </div>
          </div>
        )}
      </div>
    );
  };

  // Real-time research generation
  const generateHuntingIdea = (threat) => {
    const ideas = [
      {
        title: `Hunt for ${threat.name} Infrastructure`,
        description: `Search for command and control infrastructure associated with ${threat.name} using network traffic analysis and DNS queries.`,
        priority: 'High',
        estimatedTime: '2-4 hours',
        tools: ['Splunk', 'Wireshark', 'PassiveTotal'],
        queries: [
          `NetworkConnectionEvents | where RemoteIP in ("${threat.indicators ? threat.indicators[0] : 'unknown'}")`,
          `DnsEvents | where QueryName contains "${threat.indicators ? threat.indicators[1] : 'unknown'}"`
        ]
      },
      {
        title: `${threat.name} Persistence Mechanisms`,
        description: `Investigate persistence techniques used by ${threat.name} including registry modifications, scheduled tasks, and service installations.`,
        priority: 'Medium',
        estimatedTime: '1-3 hours',
        tools: ['PowerShell', 'Autoruns', 'RegRipper'],
        queries: [
          `SecurityEvent | where EventID in (4698, 4699, 4700, 4701)`,
          `RegistryEvent | where RegistryKey contains "Run"`
        ]
      }
    ];
    return ideas[Math.floor(Math.random() * ideas.length)];
  };

  const toggleSection = (section) => {
    setExpandedSections(prev => ({
      ...prev,
      [section]: !prev[section]
    }));
  };

  const executeQuery = (query, type) => {
    setIsExecuting(true);
    setActiveQuery(query);
    
    // Simulate query execution
    setTimeout(() => {
      const mockResults = [
        { timestamp: '2025-08-14T10:30:00Z', computer: 'WORKSTATION-01', user: 'john.doe', severity: 'High', description: 'Suspicious PowerShell execution detected' },
        { timestamp: '2025-08-14T10:25:00Z', computer: 'SERVER-02', user: 'admin', severity: 'Critical', description: 'Potential lateral movement detected' },
        { timestamp: '2025-08-14T10:20:00Z', computer: 'WORKSTATION-03', user: 'jane.smith', severity: 'Medium', description: 'Unusual network connection pattern' }
      ];
      setQueryResults(mockResults);
      setIsExecuting(false);
      
      // Add notification
      const notification = {
        id: Date.now(),
        message: `Query executed successfully - ${mockResults.length} results found`,
        type: 'success'
      };
      setNotifications(prev => [notification, ...prev.slice(0, 4)]);
    }, 1500);
  };

  const copyToClipboard = (text) => {
    navigator.clipboard.writeText(text);
    const notification = {
      id: Date.now(),
      message: 'Copied to clipboard',
      type: 'success'
    };
    setNotifications(prev => [notification, ...prev.slice(0, 4)]);
  };

  const dismissNotification = (id) => {
    setNotifications(prev => prev.filter(n => n.id !== id));
  };

  useEffect(() => {
    // Initial load of threat feeds
    fetchLiveThreatFeeds();
    
    // Set up real-time updates every 5 minutes
    const feedInterval = setInterval(() => {
      fetchLiveThreatFeeds();
    }, 300000);

    // Generate new IOCs every 30 seconds for demo
    const iocInterval = setInterval(() => {
      setLiveFeeds(prev => ({
        ...prev,
        urlhaus: generateLiveIOCs().slice(0, 5),
        abuseIPDB: generateLiveIOCs().slice(5, 10),
        malwareBazaar: generateLiveIOCs().slice(10, 15)
      }));
    }, 30000);

    return () => {
      clearInterval(feedInterval);
      clearInterval(iocInterval);
    };
  }, []);

  useEffect(() => {
    // Auto-dismiss notifications after 3 seconds
    const timer = setTimeout(() => {
      setNotifications(prev => prev.slice(0, 3));
    }, 3000);
    return () => clearTimeout(timer);
  }, [notifications]);

  return (
    <div className="min-h-screen bg-gradient-to-br from-gray-900 via-blue-900 to-gray-900 text-white">
      {/* Notifications */}
      <div className="fixed top-4 right-4 z-50 space-y-2">
        {notifications.map(notification => (
          <div
            key={notification.id}
            className={`px-4 py-2 rounded-lg shadow-lg transition-all duration-300 transform ${
              notification.type === 'success' ? 'bg-green-600' : 'bg-red-600'
            }`}
            onClick={() => dismissNotification(notification.id)}
          >
            <p className="text-sm cursor-pointer">{notification.message}</p>
          </div>
        ))}
      </div>

      {/* Header */}
      <header className="bg-gray-800/80 backdrop-blur-sm border-b border-cyan-500/30 px-6 py-4">
        <div className="flex items-center justify-between">
          <div className="flex items-center space-x-4">
            <div className="flex items-center space-x-2">
              <Crosshair className="w-8 h-8 text-cyan-400" />
              <h1 className="text-2xl font-bold bg-gradient-to-r from-cyan-400 to-blue-400 bg-clip-text text-transparent">
                ELITE THREAT HUNTER
              </h1>
            </div>
            <div className="flex items-center space-x-1 bg-gray-700/50 px-3 py-1 rounded-full">
              <div className="w-2 h-2 bg-green-400 rounded-full animate-pulse"></div>
              <span className="text-xs text-gray-300">Live Hunting Active</span>
            </div>
          </div>
          <div className="flex items-center space-x-4">
            <button className="p-2 hover:bg-gray-700 rounded-lg transition-colors">
              <Settings className="w-5 h-5 text-gray-400" />
            </button>
            <button className="p-2 hover:bg-gray-700 rounded-lg transition-colors">
              <Download className="w-5 h-5 text-gray-400" />
            </button>
          </div>
        </div>
      </header>

      <div className="flex h-screen">
        {/* Sidebar Navigation */}
        <aside className="w-64 bg-gray-800/50 backdrop-blur-sm border-r border-cyan-500/30 p-4">
          <nav className="space-y-2">
            {[
              { id: 'dashboard', icon: Activity, label: 'Threat Dashboard' },
              { id: 'hunting', icon: Target, label: 'Active Hunting' },
              { id: 'intelligence', icon: Brain, label: 'Threat Intel' },
              { id: 'playbooks', icon: Book, label: 'Hunt Playbooks' },
              { id: 'queries', icon: Database, label: 'Query Builder' },
              { id: 'resources', icon: Globe, label: 'Resources' }
            ].map(item => (
              <button
                key={item.id}
                onClick={() => setActiveTab(item.id)}
                className={`w-full flex items-center space-x-3 px-3 py-3 rounded-lg transition-all duration-200 ${
                  activeTab === item.id
                    ? 'bg-cyan-600/30 text-cyan-300 border border-cyan-500/50'
                    : 'text-gray-400 hover:text-white hover:bg-gray-700/50'
                }`}
              >
                <item.icon className="w-5 h-5" />
                <span className="font-medium">{item.label}</span>
              </button>
            ))}
          </nav>

          {/* Quick Stats */}
          <div className="mt-8 p-4 bg-gray-900/50 rounded-lg border border-cyan-500/20">
            <h3 className="text-sm font-semibold text-cyan-400 mb-3">Hunt Statistics</h3>
            <div className="space-y-2 text-sm">
              <div className="flex justify-between">
                <span className="text-gray-400">Active Hunts</span>
                <span className="text-white font-medium">7</span>
              </div>
              <div className="flex justify-between">
                <span className="text-gray-400">Threats Detected</span>
                <span className="text-red-400 font-medium">3</span>
              </div>
              <div className="flex justify-between">
                <span className="text-gray-400">Queries Run</span>
                <span className="text-green-400 font-medium">47</span>
              </div>
            </div>
          </div>
        </aside>

        {/* Main Content */}
        <main className="flex-1 overflow-auto">
          {activeTab === 'dashboard' && (
            <div className="p-6">
              <div className="mb-6">
                <h2 className="text-3xl font-bold text-white mb-2">Threat Hunting Dashboard</h2>
                <p className="text-gray-400">Real-time threat detection and hunting operations center</p>
              </div>

              {/* Live Threat Intelligence Feed */}
              <div className="mb-8">
                <div className="flex items-center justify-between mb-4">
                  <h3 className="text-xl font-semibold text-white">Live Threat Intelligence</h3>
                  <button 
                    onClick={fetchLiveThreatFeeds}
                    disabled={isLoadingFeeds}
                    className="flex items-center space-x-2 px-4 py-2 bg-cyan-600 text-white rounded hover:bg-cyan-700 transition-colors disabled:opacity-50"
                  >
                    {isLoadingFeeds ? (
                      <div className="w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"></div>
                    ) : (
                      <Eye className="w-4 h-4" />
                    )}
                    <span>Refresh Feeds</span>
                  </button>
                </div>

                {/* CISA Known Exploited Vulnerabilities */}
                <div className="mb-6">
                  <h4 className="text-lg font-semibold text-white mb-3">CISA Known Exploited Vulnerabilities</h4>
                  <div className="grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-4">
                    {liveFeeds.cisaKev.slice(0, 6).map((vuln, index) => (
                      <ThreatExplanationCard key={index} item={vuln} type="cisaKev">
                        <div className="bg-gray-800/50 rounded-lg border border-red-500/30 p-4 hover:border-red-500/50 transition-all">
                          <div className="flex items-start justify-between mb-2 pr-8">
                            <h5 className="text-white font-semibold">{vuln.cveID}</h5>
                            <span className="px-2 py-1 bg-red-600/20 text-red-300 rounded text-xs">
                              KEV
                            </span>
                          </div>
                          <p className="text-sm text-gray-300 mb-2">{vuln.vulnerabilityName}</p>
                          <p className="text-xs text-gray-400 mb-3">{vuln.shortDescription}</p>
                          
                          <div className="space-y-1 mb-3 text-xs">
                            <div className="flex justify-between">
                              <span className="text-gray-400">Vendor:</span>
                              <span className="text-white">{vuln.vendorProject}</span>
                            </div>
                            <div className="flex justify-between">
                              <span className="text-gray-400">Due Date:</span>
                              <span className="text-red-300">{vuln.dueDate}</span>
                            </div>
                            <div className="flex justify-between">
                              <span className="text-gray-400">Ransomware:</span>
                              <span className={vuln.knownRansomwareCampaignUse === 'Known' ? 'text-red-300' : 'text-green-300'}>
                                {vuln.knownRansomwareCampaignUse || 'Unknown'}
                              </span>
                            </div>
                          </div>
                          
                          <div className="flex space-x-2">
                            <button
                              onClick={() => {
                                copyToClipboard(vuln.cveID);
                                const notification = {
                                  id: Date.now(),
                                  message: `CVE copied: ${vuln.cveID}`,
                                  type: 'success'
                                };
                                setNotifications(prev => [notification, ...prev.slice(0, 4)]);
                              }}
                              className="flex-1 px-2 py-1 bg-gray-700 text-white rounded text-xs hover:bg-gray-600 transition-colors"
                            >
                              Copy CVE
                            </button>
                            <button
                              onClick={() => window.open(`https://nvd.nist.gov/vuln/detail/${vuln.cveID}`, '_blank')}
                              className="flex-1 px-2 py-1 bg-red-600 text-white rounded text-xs hover:bg-red-700 transition-colors"
                            >
                              NVD Details
                            </button>
                          </div>
                        </div>
                      </ThreatExplanationCard>
                    ))}
                  </div>
                </div>

                {/* CISA Security Alerts */}
                <div className="mb-6">
                  <h4 className="text-lg font-semibold text-white mb-3">CISA Security Alerts</h4>
                  <div className="grid grid-cols-1 lg:grid-cols-2 gap-4">
                    {liveFeeds.cisaAlerts.map((alert, index) => (
                      <ThreatExplanationCard key={index} item={alert} type="cisaAlert">
                        <div className="bg-gray-800/50 rounded-lg border border-orange-500/30 p-4 hover:border-orange-500/50 transition-all">
                          <div className="flex items-start justify-between mb-2 pr-8">
                            <h5 className="text-lg font-semibold text-white">{alert.title}</h5>
                            <span className="px-2 py-1 bg-orange-600/20 text-orange-300 rounded text-xs">
                              {alert.severity}
                            </span>
                          </div>
                          <p className="text-sm text-gray-300 mb-3">{alert.summary}</p>
                          
                          <div className="mb-3">
                            <h6 className="text-xs font-semibold text-cyan-400 mb-1">Alert ID: {alert.id}</h6>
                            <div className="flex flex-wrap gap-1">
                              {alert.tags.map((tag, tagIndex) => (
                                <span
                                  key={tagIndex}
                                  className="px-1 py-0.5 bg-gray-700/50 text-gray-300 rounded text-xs"
                                >
                                  {tag}
                                </span>
                              ))}
                            </div>
                          </div>
                          
                          <div className="flex items-center justify-between">
                            <span className="text-xs text-gray-400">CISA • {new Date(alert.published).toLocaleTimeString()}</span>
                            <div className="flex space-x-2">
                              <button
                                onClick={() => {
                                  copyToClipboard(alert.id);
                                  const notification = {
                                    id: Date.now(),
                                    message: `Alert ID copied: ${alert.id}`,
                                    type: 'success'
                                  };
                                  setNotifications(prev => [notification, ...prev.slice(0, 4)]);
                                }}
                                className="px-2 py-1 bg-gray-700 text-white rounded text-xs hover:bg-gray-600 transition-colors"
                              >
                                Copy ID
                              </button>
                              <button
                                onClick={() => window.open(alert.url, '_blank')}
                                className="px-3 py-1 bg-orange-600 text-white rounded text-xs hover:bg-orange-700 transition-colors"
                              >
                                Full Alert
                              </button>
                            </div>
                          </div>
                        </div>
                      </ThreatExplanationCard>
                    ))}
                  </div>
                </div>
                
                <div className="grid grid-cols-1 lg:grid-cols-2 gap-4">
                  {liveFeeds.threatIntel.map((intel, index) => (
                    <ThreatExplanationCard key={index} item={intel} type="threatIntel">
                      <div className="bg-gray-800/50 rounded-lg border border-gray-700 p-4 hover:border-cyan-500/50 transition-all">
                        <div className="flex items-start justify-between mb-2 pr-8">
                          <h4 className="text-lg font-semibold text-white">{intel.title}</h4>
                          <span className={`px-2 py-1 rounded text-xs ${
                            intel.severity === 'Critical' ? 'bg-red-600/20 text-red-300' : 'bg-orange-600/20 text-orange-300'
                          }`}>
                            {intel.severity}
                          </span>
                        </div>
                        <p className="text-gray-300 text-sm mb-3">{intel.summary}</p>
                        
                        <div className="grid grid-cols-2 gap-4 mb-3">
                          <div>
                            <h5 className="text-xs font-semibold text-cyan-400 mb-1">IOCs ({intel.iocs.length})</h5>
                            <div className="space-y-1">
                              {intel.iocs.slice(0, 2).map((ioc, iocIndex) => (
                                <button
                                  key={iocIndex}
                                  onClick={() => {
                                    copyToClipboard(ioc);
                                    const notification = {
                                      id: Date.now(),
                                      message: `IOC copied: ${ioc}`,
                                      type: 'success'
                                    };
                                    setNotifications(prev => [notification, ...prev.slice(0, 4)]);
                                  }}
                                  className="block w-full text-left px-2 py-1 bg-gray-900/50 rounded text-xs text-gray-300 hover:bg-gray-700/50 transition-colors font-mono"
                                >
                                  {ioc}
                                </button>
                              ))}
                            </div>
                          </div>
                          <div>
                            <h5 className="text-xs font-semibold text-cyan-400 mb-1">TTPs ({intel.ttps.length})</h5>
                            <div className="flex flex-wrap gap-1">
                              {intel.ttps.map((ttp, ttpIndex) => (
                                <button
                                  key={ttpIndex}
                                  onClick={() => window.open(`https://attack.mitre.org/techniques/${ttp.replace('.', '/')}/`, '_blank')}
                                  className="px-1 py-0.5 bg-blue-600/20 text-blue-300 rounded text-xs hover:bg-blue-600/30 transition-colors"
                                >
                                  {ttp}
                                </button>
                              ))}
                            </div>
                          </div>
                        </div>
                        
                        <div className="flex items-center justify-between">
                          <span className="text-xs text-gray-400">{intel.source} • {new Date(intel.published).toLocaleTimeString()}</span>
                          <button 
                            onClick={() => {
                              const huntIdea = generateHuntingIdea({ name: intel.title, indicators: intel.iocs });
                              const notification = {
                                id: Date.now(),
                                message: `Generated hunt idea: ${huntIdea.title}`,
                                type: 'success'
                              };
                              setNotifications(prev => [notification, ...prev.slice(0, 4)]);
                            }}
                            className="px-3 py-1 bg-cyan-600/20 text-cyan-300 rounded text-xs hover:bg-cyan-600/30 transition-colors"
                          >
                            Generate Hunt
                          </button>
                        </div>
                      </div>
                    </ThreatExplanationCard>
                  ))}
                </div>
              </div>

              {/* Live IOC Feeds */}
              <div className="mb-8">
                <h3 className="text-xl font-semibold text-white mb-4">Live IOC Feeds</h3>
                <div className="grid grid-cols-1 lg:grid-cols-3 gap-4">
                  {/* URLhaus Feed */}
                  <div className="bg-gray-800/50 rounded-lg border border-gray-700 p-4">
                    <div className="flex items-center justify-between mb-3">
                      <h4 className="font-semibold text-white">URLhaus</h4>
                      <div className="flex items-center space-x-1">
                        <div className="w-2 h-2 bg-green-400 rounded-full animate-pulse"></div>
                        <span className="text-xs text-green-400">Live</span>
                      </div>
                    </div>
                    <p className="text-xs text-gray-400 mb-3">Malicious URL database for threat hunting and incident response</p>
                    <div className="space-y-2 max-h-32 overflow-y-auto">
                      {liveFeeds.urlhaus.map((ioc, index) => (
                        <ThreatExplanationCard key={index} item={ioc} type="ioc">
                          <button
                            onClick={() => {
                              copyToClipboard(ioc.value);
                              const notification = {
                                id: Date.now(),
                                message: `IOC copied: ${ioc.value}`,
                                type: 'success'
                              };
                              setNotifications(prev => [notification, ...prev.slice(0, 4)]);
                            }}
                            className="w-full text-left p-2 bg-gray-900/50 rounded hover:bg-gray-700/50 transition-colors relative pr-8"
                          >
                            <div className="text-xs text-gray-300 font-mono truncate">{ioc.value}</div>
                            <div className="text-xs text-gray-500">{ioc.description}</div>
                          </button>
                        </ThreatExplanationCard>
                      ))}
                    </div>
                  </div>

                  {/* AbuseIPDB Feed */}
                  <div className="bg-gray-800/50 rounded-lg border border-gray-700 p-4">
                    <div className="flex items-center justify-between mb-3">
                      <h4 className="font-semibold text-white">AbuseIPDB</h4>
                      <div className="flex items-center space-x-1">
                        <div className="w-2 h-2 bg-green-400 rounded-full animate-pulse"></div>
                        <span className="text-xs text-green-400">Live</span>
                      </div>
                    </div>
                    <p className="text-xs text-gray-400 mb-3">IP reputation database with confidence scoring for threat analysis</p>
                    <div className="space-y-2 max-h-32 overflow-y-auto">
                      {liveFeeds.abuseIPDB.map((ioc, index) => (
                        <ThreatExplanationCard key={index} item={ioc} type="ioc">
                          <button
                            onClick={() => {
                              copyToClipboard(ioc.value);
                              window.open(`https://www.abuseipdb.com/check/${ioc.value}`, '_blank');
                            }}
                            className="w-full text-left p-2 bg-gray-900/50 rounded hover:bg-gray-700/50 transition-colors relative pr-8"
                          >
                            <div className="flex items-center justify-between pr-8">
                              <span className="text-xs text-gray-300 font-mono">{ioc.value}</span>
                              <span className="text-xs text-cyan-400">{ioc.confidence}%</span>
                            </div>
                            <div className="text-xs text-gray-500">{ioc.description}</div>
                          </button>
                        </ThreatExplanationCard>
                      ))}
                    </div>
                  </div>

                  {/* MalwareBazaar Feed */}
                  <div className="bg-gray-800/50 rounded-lg border border-gray-700 p-4">
                    <div className="flex items-center justify-between mb-3">
                      <h4 className="font-semibold text-white">MalwareBazaar</h4>
                      <div className="flex items-center space-x-1">
                        <div className="w-2 h-2 bg-green-400 rounded-full animate-pulse"></div>
                        <span className="text-xs text-green-400">Live</span>
                      </div>
                    </div>
                    <p className="text-xs text-gray-400 mb-3">Malware sample repository with hash indicators for threat detection</p>
                    <div className="space-y-2 max-h-32 overflow-y-auto">
                      {liveFeeds.malwareBazaar.map((ioc, index) => (
                        <ThreatExplanationCard key={index} item={ioc} type="ioc">
                          <button
                            onClick={() => {
                              copyToClipboard(ioc.value);
                              const notification = {
                                id: Date.now(),
                                message: `Hash copied: ${ioc.value.slice(0, 16)}...`,
                                type: 'success'
                              };
                              setNotifications(prev => [notification, ...prev.slice(0, 4)]);
                            }}
                            className="w-full text-left p-2 bg-gray-900/50 rounded hover:bg-gray-700/50 transition-colors relative pr-8"
                          >
                            <div className="text-xs text-gray-300 font-mono truncate">{ioc.value}</div>
                            <div className="text-xs text-gray-500">{ioc.tags}</div>
                          </button>
                        </ThreatExplanationCard>
                      ))}
                    </div>
                  </div>
                </div>
              </div>

              {/* Active Threats Overview */}
              <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-8">
                {Object.entries(threatCategories).map(([category, data]) => {
                  const IconComponent = data.icon;
                  return (
                    <button
                      key={category}
                      onClick={() => {
                        setActiveTab('intelligence');
                        setSelectedThreat(category);
                      }}
                      className="p-4 bg-gray-800/50 rounded-lg border border-gray-700 hover:border-cyan-500/50 transition-all duration-200 group"
                    >
                      <div className="flex items-center space-x-3 mb-3">
                        <IconComponent className="w-6 h-6" style={{ color: data.color }} />
                        <h3 className="font-semibold text-white group-hover:text-cyan-300">{category}</h3>
                      </div>
                      <div className="text-left">
                        <p className="text-2xl font-bold text-white">{data.threats.length}</p>
                        <p className="text-sm text-gray-400">Active Threats</p>
                      </div>
                    </button>
                  );
                })}
              </div>

              {/* Recent Activity */}
              <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <div className="bg-gray-800/50 rounded-lg border border-gray-700 p-6">
                  <h3 className="text-xl font-semibold text-white mb-4">Recent Detections</h3>
                  <div className="space-y-3">
                    {[
                      { time: '10:45 AM', threat: 'Suspicious PowerShell', severity: 'High', host: 'WS-001' },
                      { time: '10:30 AM', threat: 'Lateral Movement', severity: 'Critical', host: 'SRV-DB01' },
                      { time: '10:15 AM', threat: 'File Encryption', severity: 'Critical', host: 'WS-007' },
                      { time: '09:55 AM', threat: 'Credential Dump', severity: 'High', host: 'DC-01' }
                    ].map((detection, index) => (
                      <div key={index} className="flex items-center justify-between p-3 bg-gray-900/50 rounded-lg">
                        <div className="flex items-center space-x-3">
                          <div className={`w-3 h-3 rounded-full ${
                            detection.severity === 'Critical' ? 'bg-red-500' : 'bg-orange-500'
                          }`}></div>
                          <div>
                            <p className="text-white font-medium">{detection.threat}</p>
                            <p className="text-sm text-gray-400">{detection.host} • {detection.time}</p>
                          </div>
                        </div>
                        <button className="px-3 py-1 bg-cyan-600 text-white rounded text-sm hover:bg-cyan-700 transition-colors">
                          Investigate
                        </button>
                      </div>
                    ))}
                  </div>
                </div>

                <div className="bg-gray-800/50 rounded-lg border border-gray-700 p-6">
                  <h3 className="text-xl font-semibold text-white mb-4">Active Hunt Progress</h3>
                  <div className="space-y-4">
                    {huntingPlaybooks.slice(0, 3).map((playbook, index) => (
                      <div key={index} className="p-3 bg-gray-900/50 rounded-lg">
                        <div className="flex justify-between items-start mb-2">
                          <h4 className="text-white font-medium">{playbook.title}</h4>
                          <span className="text-xs bg-blue-600 text-white px-2 py-1 rounded">{playbook.difficulty}</span>
                        </div>
                        <div className="mb-2">
                          <div className="flex justify-between text-sm mb-1">
                            <span className="text-gray-400">Progress</span>
                            <span className="text-gray-400">{Math.floor(Math.random() * 40) + 60}%</span>
                          </div>
                          <div className="w-full bg-gray-700 rounded-full h-2">
                            <div 
                              className="bg-gradient-to-r from-cyan-500 to-blue-500 h-2 rounded-full" 
                              style={{ width: `${Math.floor(Math.random() * 40) + 60}%` }}
                            ></div>
                          </div>
                        </div>
                        <p className="text-sm text-gray-400">{playbook.queries} queries completed</p>
                      </div>
                    ))}
                  </div>
                </div>
              </div>
            </div>
          )}

          {activeTab === 'intelligence' && (
            <div className="p-6">
              <div className="mb-6">
                <h2 className="text-3xl font-bold text-white mb-2">Threat Intelligence</h2>
                <p className="text-gray-400">Comprehensive threat profiles with hunting queries and resources</p>
              </div>

              <div className="grid grid-cols-1 lg:grid-cols-3 gap-6">
                {/* Threat Categories */}
                <div className="lg:col-span-1">
                  <div className="bg-gray-800/50 rounded-lg border border-gray-700 p-4">
                    <h3 className="text-lg font-semibold text-white mb-4">Threat Categories</h3>
                    <div className="space-y-2">
                      {Object.entries(threatCategories).map(([category, data]) => {
                        const IconComponent = data.icon;
                        return (
                          <button
                            key={category}
                            onClick={() => setSelectedThreat(category)}
                            className={`w-full flex items-center space-x-3 p-3 rounded-lg transition-all duration-200 ${
                              selectedThreat === category
                                ? 'bg-cyan-600/30 border border-cyan-500/50'
                                : 'hover:bg-gray-700/50'
                            }`}
                          >
                            <IconComponent className="w-5 h-5" style={{ color: data.color }} />
                            <span className="text-white font-medium">{category}</span>
                            <span className="ml-auto bg-gray-600 text-white text-xs px-2 py-1 rounded-full">
                              {data.threats.length}
                            </span>
                          </button>
                        );
                      })}
                    </div>
                  </div>
                </div>

                {/* Threat Details */}
                <div className="lg:col-span-2">
                  {selectedThreat && (
                    <div className="space-y-4">
                      {threatCategories[selectedThreat].threats.map((threat, index) => (
                        <div key={index} className="bg-gray-800/50 rounded-lg border border-gray-700 p-6">
                          <div className="flex items-start justify-between mb-4">
                            <div>
                              <h3 className="text-xl font-bold text-white mb-2">{threat.name}</h3>
                              <span className={`px-3 py-1 rounded-full text-sm font-medium ${
                                threat.severity === 'Critical' ? 'bg-red-600/20 text-red-300 border border-red-500/30' :
                                threat.severity === 'High' ? 'bg-orange-600/20 text-orange-300 border border-orange-500/30' :
                                'bg-yellow-600/20 text-yellow-300 border border-yellow-500/30'
                              }`}>
                                {threat.severity}
                              </span>
                            </div>
                            <button 
                              onClick={() => toggleSection(`threat-${index}`)}
                              className="p-2 hover:bg-gray-700 rounded-lg transition-colors"
                            >
                              {expandedSections[`threat-${index}`] && (
                            <div className="space-y-4 border-t border-gray-700 pt-4">
                              {/* Explanation */}
                              <div>
                                <h4 className="text-sm font-semibold text-cyan-400 mb-2">Hunting Strategy</h4>
                                <div className="bg-gray-900/50 p-4 rounded-lg">
                                  <pre className="text-sm text-gray-300 whitespace-pre-wrap">{threat.explanation}</pre>
                                </div>
                              </div>

                              {/* Queries */}
                              <div>
                                <h4 className="text-sm font-semibold text-cyan-400 mb-2">Detection Queries</h4>
                                <div className="space-y-3">
                                  {Object.entries(threat.queries).map(([platform, query]) => (
                                    <div key={platform} className="bg-gray-900/50 rounded-lg border border-gray-700">
                                      <div className="flex items-center justify-between p-3 border-b border-gray-700">
                                        <h5 className="font-medium text-white uppercase">{platform}</h5>
                                        <div className="flex space-x-2">
                                          <button
                                            onClick={() => copyToClipboard(query)}
                                            className="p-1 hover:bg-gray-700 rounded transition-colors"
                                          >
                                            <Copy className="w-4 h-4 text-gray-400" />
                                          </button>
                                          <button
                                            onClick={() => executeQuery(query, platform)}
                                            className="p-1 hover:bg-gray-700 rounded transition-colors"
                                          >
                                            <Play className="w-4 h-4 text-cyan-400" />
                                          </button>
                                        </div>
                                      </div>
                                      <div className="p-3">
                                        <pre className="text-sm text-gray-300 overflow-x-auto">{query}</pre>
                                      </div>
                                    </div>
                                  ))}
                                </div>
                              </div>
                            </div>
                          )}
                        </div>
                      ))}
                    </div>
                  )}
                  {!selectedThreat && (
                    <div className="bg-gray-800/50 rounded-lg border border-gray-700 p-8 text-center">
                      <Target className="w-16 h-16 text-gray-600 mx-auto mb-4" />
                      <h3 className="text-xl font-semibold text-white mb-2">Select a Threat Category</h3>
                      <p className="text-gray-400">Choose a threat category from the sidebar to view detailed intelligence and hunting queries</p>
                    </div>
                  )}
                </div>
              </div>
            </div>
          )}

          {activeTab === 'playbooks' && (
            <div className="p-6">
              <div className="mb-6">
                <h2 className="text-3xl font-bold text-white mb-2">Hunting Playbooks</h2>
                <p className="text-gray-400">Structured hunting methodologies and step-by-step guides</p>
              </div>

              <div className="grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6">
                {huntingPlaybooks.map((playbook, index) => (
                  <div key={index} className="bg-gray-800/50 rounded-lg border border-gray-700 p-6 hover:border-cyan-500/50 transition-all duration-200">
                    <div className="flex items-start justify-between mb-4">
                      <h3 className="text-xl font-bold text-white">{playbook.title}</h3>
                      <span className={`px-2 py-1 rounded text-xs font-medium ${
                        playbook.difficulty === 'Expert' ? 'bg-red-600/20 text-red-300' :
                        playbook.difficulty === 'Advanced' ? 'bg-orange-600/20 text-orange-300' :
                        'bg-green-600/20 text-green-300'
                      }`}>
                        {playbook.difficulty}
                      </span>
                    </div>
                    
                    <p className="text-gray-300 mb-4">{playbook.description}</p>
                    
                    <div className="mb-4">
                      <h4 className="text-sm font-semibold text-cyan-400 mb-2">Hunting Steps</h4>
                      <ul className="space-y-1">
                        {playbook.steps.map((step, stepIndex) => (
                          <li key={stepIndex} className="text-sm text-gray-300 flex items-center">
                            <div className="w-1.5 h-1.5 bg-cyan-400 rounded-full mr-2"></div>
                            {step}
                          </li>
                        ))}
                      </ul>
                    </div>
                    
                    <div className="flex items-center justify-between">
                      <div className="text-sm text-gray-400">
                        {playbook.queries} detection queries included
                      </div>
                      <button 
                        onClick={() => {
                          const notification = {
                            id: Date.now(),
                            message: `Loading ${playbook.title} playbook...`,
                            type: 'success'
                          };
                          setNotifications(prev => [notification, ...prev.slice(0, 4)]);
                        }}
                        className="px-4 py-2 bg-cyan-600 text-white rounded hover:bg-cyan-700 transition-colors"
                      >
                        Start Hunt
                      </button>
                    </div>
                  </div>
                ))}
              </div>
            </div>
          )}

          {activeTab === 'queries' && (
            <div className="p-6">
              <div className="mb-6">
                <h2 className="text-3xl font-bold text-white mb-2">Query Execution Center</h2>
                <p className="text-gray-400">Execute hunting queries and analyze results in real-time</p>
              </div>

              <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
                {/* Query Editor */}
                <div className="space-y-4">
                  <div className="bg-gray-800/50 rounded-lg border border-gray-700 p-4">
                    <div className="flex items-center justify-between mb-4">
                      <h3 className="text-lg font-semibold text-white">Query Editor</h3>
                      <div className="flex space-x-2">
                        <button
                          onClick={() => copyToClipboard(activeQuery)}
                          className="p-2 hover:bg-gray-700 rounded transition-colors"
                        >
                          <Copy className="w-4 h-4 text-gray-400" />
                        </button>
                        <button
                          onClick={() => executeQuery(activeQuery, 'kql')}
                          disabled={isExecuting}
                          className="flex items-center space-x-2 px-4 py-2 bg-cyan-600 text-white rounded hover:bg-cyan-700 transition-colors disabled:opacity-50"
                        >
                          {isExecuting ? (
                            <>
                              <div className="w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"></div>
                              <span>Executing...</span>
                            </>
                          ) : (
                            <>
                              <Play className="w-4 h-4" />
                              <span>Execute</span>
                            </>
                          )}
                        </button>
                      </div>
                    </div>
                    <textarea
                      value={activeQuery}
                      onChange={(e) => setActiveQuery(e.target.value)}
                      className="w-full h-64 bg-gray-900/50 text-gray-300 p-4 rounded-lg border border-gray-700 font-mono text-sm resize-none focus:outline-none focus:border-cyan-500"
                      placeholder="Enter your hunting query here..."
                    />
                  </div>

                  {/* Quick Query Templates */}
                  <div className="bg-gray-800/50 rounded-lg border border-gray-700 p-4">
                    <h3 className="text-lg font-semibold text-white mb-4">Quick Templates</h3>
                    <div className="space-y-2">
                      {[
                        {
                          name: 'PowerShell Execution',
                          query: `SecurityEvent\n| where EventID == 4688\n| where Process endswith "powershell.exe"\n| project TimeGenerated, Computer, Account, CommandLine`
                        },
                        {
                          name: 'Failed Logons',
                          query: `SecurityEvent\n| where EventID == 4625\n| summarize count() by Account, Computer\n| sort by count_ desc`
                        },
                        {
                          name: 'Network Connections',
                          query: `NetworkConnectionEvents\n| where TimeGenerated > ago(1h)\n| summarize count() by RemoteIP, RemotePort\n| sort by count_ desc`
                        }
                      ].map((template, index) => (
                        <button
                          key={index}
                          onClick={() => setActiveQuery(template.query)}
                          className="w-full text-left p-3 bg-gray-900/50 rounded hover:bg-gray-700/50 transition-colors"
                        >
                          <div className="text-white font-medium">{template.name}</div>
                          <div className="text-sm text-gray-400 mt-1">Click to load template</div>
                        </button>
                      ))}
                    </div>
                  </div>
                </div>

                {/* Results Panel */}
                <div className="bg-gray-800/50 rounded-lg border border-gray-700 p-4">
                  <div className="flex items-center justify-between mb-4">
                    <h3 className="text-lg font-semibold text-white">Query Results</h3>
                    {queryResults.length > 0 && (
                      <div className="flex items-center space-x-2">
                        <span className="text-sm text-gray-400">{queryResults.length} results</span>
                        <button className="p-2 hover:bg-gray-700 rounded transition-colors">
                          <Download className="w-4 h-4 text-gray-400" />
                        </button>
                      </div>
                    )}
                  </div>

                  {queryResults.length > 0 ? (
                    <div className="space-y-2 max-h-96 overflow-y-auto">
                      {queryResults.map((result, index) => (
                        <div key={index} className="p-3 bg-gray-900/50 rounded border border-gray-700">
                          <div className="flex items-center justify-between mb-2">
                            <span className="text-sm text-gray-400">{result.timestamp}</span>
                            <span className={`px-2 py-1 rounded text-xs ${
                              result.severity === 'Critical' ? 'bg-red-600/20 text-red-300' :
                              result.severity === 'High' ? 'bg-orange-600/20 text-orange-300' :
                              'bg-yellow-600/20 text-yellow-300'
                            }`}>
                              {result.severity}
                            </span>
                          </div>
                          <div className="text-white font-medium mb-1">{result.description}</div>
                          <div className="text-sm text-gray-400">
                            {result.computer} • {result.user}
                          </div>
                        </div>
                      ))}
                    </div>
                  ) : (
                    <div className="text-center py-12">
                      <Database className="w-16 h-16 text-gray-600 mx-auto mb-4" />
                      <p className="text-gray-400">Execute a query to see results here</p>
                    </div>
                  )}
                </div>
              </div>
            </div>
          )}

          {activeTab === 'resources' && (
            <div className="p-6">
              <div className="mb-6">
                <h2 className="text-3xl font-bold text-white mb-2">Hunting Resources</h2>
                <p className="text-gray-400">Curated collection of threat hunting tools and live data feeds</p>
              </div>

              {/* Live API Integrations */}
              <div className="mb-8">
                <h3 className="text-xl font-semibold text-white mb-4">Live API Integrations</h3>
                <div className="grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-4">
                  {[
                    {
                      name: 'CISA KEV API',
                      description: 'Known Exploited Vulnerabilities catalog with exploitation evidence and due dates',
                      status: 'active',
                      endpoint: 'https://www.cisa.gov/sites/default/files/feeds/known_exploited_vulnerabilities.json',
                      rateLimit: 'Unlimited',
                      usage: 'Priority vulnerability management and incident response'
                    },
                    {
                      name: 'CISA AIS Feed',
                      description: 'Automated Indicator Sharing with government and private sector',
                      status: 'active',
                      endpoint: 'https://www.cisa.gov/ais',
                      rateLimit: 'Registration required',
                      usage: 'Real-time threat indicator sharing and analysis'
                    },
                    {
                      name: 'CIRCL CVE API',
                      description: 'Real-time CVE vulnerability data with detailed descriptions and CVSS scores',
                      status: 'active',
                      endpoint: 'https://cve.circl.lu/api',
                      rateLimit: '100/hour',
                      usage: 'Vulnerability intelligence and patch prioritization'
                    },
                    {
                      name: 'AbuseIPDB API',
                      description: 'IP reputation service with confidence scoring and abuse reporting',
                      status: 'active', 
                      endpoint: 'https://api.abuseipdb.com/v2',
                      rateLimit: '1000/day',
                      usage: 'IP threat intelligence and network security'
                    },
                    {
                      name: 'URLhaus API',
                      description: 'Malicious URL database for threat hunting and incident response',
                      status: 'active',
                      endpoint: 'https://urlhaus-api.abuse.ch/v1',
                      rateLimit: 'Unlimited',
                      usage: 'URL analysis and web threat detection'
                    },
                    {
                      name: 'MalwareBazaar API',
                      description: 'Malware sample repository with hash indicators and family classification',
                      status: 'active',
                      endpoint: 'https://mb-api.abuse.ch/api/v1',
                      rateLimit: 'Unlimited', 
                      usage: 'Malware analysis and hash lookups'
                    },
                    {
                      name: 'ThreatFox API',
                      description: 'IOC database with contextual information and threat attribution',
                      status: 'active',
                      endpoint: 'https://threatfox-api.abuse.ch/api/v1',
                      rateLimit: 'Unlimited',
                      usage: 'IOC enrichment and threat correlation'
                    },
                    {
                      name: 'US-CERT RSS Feeds',
                      description: 'Security advisories, alerts, and vulnerability notes from CISA',
                      status: 'active',
                      endpoint: 'https://www.cisa.gov/uscert/ncas/alerts.xml',
                      rateLimit: 'Unlimited',
                      usage: 'Government security alerts and advisories'
                    },
                    {
                      name: 'Shodan API',
                      description: 'Internet-connected device search engine for reconnaissance',
                      status: 'limited',
                      endpoint: 'https://api.shodan.io',
                      rateLimit: '100/month (free)',
                      usage: 'Attack surface discovery and asset enumeration'
                    }
                  ].map((api, index) => (
                    <div key={index} className="bg-gray-800/50 rounded-lg border border-gray-700 p-4 hover:border-cyan-500/50 transition-all">
                      <div className="flex items-start justify-between mb-2">
                        <h4 className="text-lg font-semibold text-white">{api.name}</h4>
                        <div className={`px-2 py-1 rounded text-xs ${
                          api.status === 'active' ? 'bg-green-600/20 text-green-300' : 'bg-yellow-600/20 text-yellow-300'
                        }`}>
                          {api.status}
                        </div>
                      </div>
                      <p className="text-gray-300 text-sm mb-3">{api.description}</p>
                      
                      <div className="space-y-2 mb-3">
                        <div className="flex justify-between text-xs">
                          <span className="text-gray-400">Rate Limit:</span>
                          <span className="text-cyan-400">{api.rateLimit}</span>
                        </div>
                        <div className="flex justify-between text-xs">
                          <span className="text-gray-400">Usage:</span>
                          <span className="text-gray-300">{api.usage}</span>
                        </div>
                      </div>
                      
                      <div className="flex space-x-2">
                        <button
                          onClick={() => {
                            copyToClipboard(api.endpoint);
                            const notification = {
                              id: Date.now(),
                              message: `API endpoint copied: ${api.name}`,
                              type: 'success'
                            };
                            setNotifications(prev => [notification, ...prev.slice(0, 4)]);
                          }}
                          className="flex-1 px-3 py-1 bg-gray-700 text-white rounded text-xs hover:bg-gray-600 transition-colors"
                        >
                          Copy Endpoint
                        </button>
                        <button
                          onClick={() => window.open(api.endpoint, '_blank')}
                          className="flex-1 px-3 py-1 bg-cyan-600 text-white rounded text-xs hover:bg-cyan-700 transition-colors"
                        >
                          Test API
                        </button>
                      </div>
                    </div>
                  ))}
                </div>
              </div>

              {/* Research Generation Tools */}
              <div className="mb-8">
                <h3 className="text-xl font-semibold text-white mb-4">Instant Research & Hunt Ideas</h3>
                <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
                  <div className="bg-gray-800/50 rounded-lg border border-gray-700 p-6">
                    <h4 className="text-lg font-semibold text-white mb-4">Quick Hunt Generator</h4>
                    <div className="space-y-3 mb-4">
                      <button 
                        onClick={() => {
                          const huntIdeas = [
                            'Hunt for PowerShell Empire C2 Communication',
                            'Detect Cobalt Strike Beacon Traffic',
                            'Identify Credential Dumping Activities',
                            'Track Lateral Movement via WMI',
                            'Monitor for DLL Injection Techniques',
                            'Search for DNS Tunneling Patterns'
                          ];
                          const randomHunt = huntIdeas[Math.floor(Math.random() * huntIdeas.length)];
                          const notification = {
                            id: Date.now(),
                            message: `Generated hunt idea: ${randomHunt}`,
                            type: 'success'
                          };
                          setNotifications(prev => [notification, ...prev.slice(0, 4)]);
                        }}
                        className="w-full p-3 bg-cyan-600 text-white rounded hover:bg-cyan-700 transition-colors"
                      >
                        Generate Random Hunt Idea
                      </button>
                      <button 
                        onClick={() => {
                          const techniques = ['T1566.001', 'T1059.003', 'T1055', 'T1083', 'T1003.001'];
                          const randomTechnique = techniques[Math.floor(Math.random() * techniques.length)];
                          window.open(`https://attack.mitre.org/techniques/${randomTechnique.replace('.', '/')}/`, '_blank');
                        }}
                        className="w-full p-3 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors"
                      >
                        Random MITRE Technique Research
                      </button>
                      <button 
                        onClick={() => {
                          const iocTypes = ['IP addresses', 'File hashes', 'Domain names', 'Registry keys', 'Process names'];
                          const randomIOC = iocTypes[Math.floor(Math.random() * iocTypes.length)];
                          const notification = {
                            id: Date.now(),
                            message: `Research focus: ${randomIOC} analysis techniques`,
                            type: 'success'
                          };
                          setNotifications(prev => [notification, ...prev.slice(0, 4)]);
                        }}
                        className="w-full p-3 bg-purple-600 text-white rounded hover:bg-purple-700 transition-colors"
                      >
                        IOC Analysis Focus
                      </button>
                    </div>
                  </div>

                  <div className="bg-gray-800/50 rounded-lg border border-gray-700 p-6">
                    <h4 className="text-lg font-semibold text-white mb-4">Live CVE Research</h4>
                    <div className="space-y-2 max-h-64 overflow-y-auto">
                      {liveFeeds.cveData.length > 0 ? liveFeeds.cveData.map((cve, index) => (
                        <button
                          key={index}
                          onClick={() => {
                            window.open(`https://cve.mitre.org/cgi-bin/cvename.cgi?name=${cve.id || `CVE-2024-${1000 + index}`}`, '_blank');
                          }}
                          className="w-full text-left p-3 bg-gray-900/50 rounded hover:bg-gray-700/50 transition-colors"
                        >
                          <div className="flex items-center justify-between mb-1">
                            <span className="text-white font-medium">{cve.id || `CVE-2024-${1000 + index}`}</span>
                            <span className="text-xs bg-red-600/20 text-red-300 px-2 py-1 rounded">
                              {cve.cvss || (7 + Math.random() * 3).toFixed(1)}
                            </span>
                          </div>
                          <p className="text-sm text-gray-300 truncate">
                            {cve.summary || 'Critical vulnerability requiring immediate attention and hunting focus'}
                          </p>
                          <div className="text-xs text-gray-400 mt-1">
                            Click to view full details and exploitation potential
                          </div>
                        </button>
                      )) : (
                        <div className="text-center py-8">
                          <Eye className="w-12 h-12 text-gray-600 mx-auto mb-2" />
                          <p className="text-gray-400">Loading CVE data...</p>
                        </div>
                      )}
                    </div>
                  </div>
                </div>
              </div>

              <div className="grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6">
                {[
                  {
                    category: 'Detection Rules',
                    icon: Shield,
                    color: '#10b981',
                    resources: [
                      { name: 'Sigma Rules', desc: 'Generic detection rules for SIEM platforms', url: 'https://github.com/SigmaHQ/sigma' },
                      { name: 'YARA Rules', desc: 'Malware detection patterns and signatures', url: 'https://github.com/Yara-Rules/rules' },
                      { name: 'Snort Rules', desc: 'Network intrusion detection signatures', url: 'https://www.snort.org/downloads/#rule-downloads' },
                      { name: 'Suricata Rules', desc: 'Open-source network security monitoring', url: 'https://suricata-ids.org/' }
                    ]
                  },
                  {
                    category: 'Threat Intelligence',
                    icon: Brain,
                    color: '#8b5cf6',
                    resources: [
                      { name: 'MITRE ATT&CK', desc: 'Adversary tactics and techniques framework', url: 'https://attack.mitre.org/' },
                      { name: 'STIX/TAXII', desc: 'Structured threat information exchange', url: 'https://oasis-open.github.io/cti-documentation/' },
                      { name: 'OpenIOC', desc: 'Open framework for sharing threat intelligence', url: 'https://www.fireeye.com/services/freeware/openioc.html' },
                      { name: 'ThreatConnect', desc: 'Threat intelligence platform and community', url: 'https://threatconnect.com/' }
                    ]
                  },
                  {
                    category: 'Analysis Tools',
                    icon: Code,
                    color: '#f59e0b',
                    resources: [
                      { name: 'Splunk', desc: 'Security information and event management platform', url: 'https://www.splunk.com/' },
                      { name: 'Elastic Stack', desc: 'Search and analytics engine for security', url: 'https://www.elastic.co/elastic-stack/' },
                      { name: 'Microsoft Sentinel', desc: 'Cloud-native SIEM and SOAR solution', url: 'https://azure.microsoft.com/en-us/services/azure-sentinel/' },
                      { name: 'Jupyter Notebooks', desc: 'Interactive analysis and research environment', url: 'https://jupyter.org/' }
                    ]
                  },
                  {
                    category: 'Malware Analysis',
                    icon: Eye,
                    color: '#ef4444',
                    resources: [
                      { name: 'Ghidra', desc: 'NSA software reverse engineering framework', url: 'https://ghidra-sre.org/' },
                      { name: 'IDA Pro', desc: 'Industry standard disassembler and debugger', url: 'https://www.hex-rays.com/products/ida/' },
                      { name: 'x64dbg', desc: 'Open-source x86/x64 debugger for Windows', url: 'https://x64dbg.com/' },
                      { name: 'Cuckoo Sandbox', desc: 'Automated malware analysis system', url: 'https://cuckoosandbox.org/' }
                    ]
                  },
                  {
                    category: 'Network Analysis',
                    icon: Globe,
                    color: '#06b6d4',
                    resources: [
                      { name: 'Wireshark', desc: 'Network protocol analyzer and packet capture', url: 'https://www.wireshark.org/' },
                      { name: 'Zeek', desc: 'Network security monitoring framework', url: 'https://zeek.org/' },
                      { name: 'NetworkMiner', desc: 'Network forensic analysis tool', url: 'https://www.netresec.com/?page=NetworkMiner' },
                      { name: 'TCPdump', desc: 'Command-line packet analyzer and capture', url: 'https://www.tcpdump.org/' }
                    ]
                  },
                  {
                    category: 'Frameworks',
                    icon: Layers,
                    color: '#84cc16',
                    resources: [
                      { name: 'NIST Cybersecurity Framework', desc: 'Comprehensive cybersecurity best practices', url: 'https://www.nist.gov/cyberframework' },
                      { name: 'SANS Hunt Methodology', desc: 'Structured threat hunting approach', url: 'https://www.sans.org/white-papers/34055/' },
                      { name: 'Diamond Model', desc: 'Intrusion analysis methodology framework', url: 'https://www.activeresponse.org/wp-content/uploads/2013/07/diamond.pdf' },
                      { name: 'Cyber Kill Chain', desc: 'Attack lifecycle and defense model', url: 'https://www.lockheedmartin.com/en-us/capabilities/cyber/cyber-kill-chain.html' }
                    ]
                  }
                ].map((category, index) => (
                  <div key={index} className="bg-gray-800/50 rounded-lg border border-gray-700 p-6">
                    <div className="flex items-center space-x-3 mb-4">
                      <category.icon className="w-6 h-6" style={{ color: category.color }} />
                      <h3 className="text-lg font-semibold text-white">{category.category}</h3>
                    </div>
                    <div className="space-y-3">
                      {category.resources.map((resource, resourceIndex) => (
                        <button
                          key={resourceIndex}
                          onClick={() => {
                            window.open(resource.url, '_blank');
                            const notification = {
                              id: Date.now(),
                              message: `Opening ${resource.name}`,
                              type: 'success'
                            };
                            setNotifications(prev => [notification, ...prev.slice(0, 4)]);
                          }}
                          className="w-full text-left p-3 bg-gray-900/50 rounded hover:bg-gray-700/50 transition-colors"
                        >
                          <div className="text-white font-medium">{resource.name}</div>
                          <div className="text-sm text-gray-400">{resource.desc}</div>
                        </button>
                      ))}
                    </div>
                  </div>
                ))}
              </div>
            </div>
          )}

          {activeTab === 'hunting' && (
            <div className="p-6">
              <div className="mb-6">
                <h2 className="text-3xl font-bold text-white mb-2">Active Hunting Operations</h2>
                <p className="text-gray-400">Monitor and manage ongoing threat hunting activities</p>
              </div>

              <div className="grid grid-cols-1 lg:grid-cols-3 gap-6">
                {/* Active Hunts */}
                <div className="lg:col-span-2 space-y-4">
                  {[
                    {
                      id: 'hunt-001',
                      name: 'Credential Harvesting Investigation',
                      status: 'In Progress',
                      priority: 'High',
                      progress: 75,
                      lastActivity: '2 minutes ago',
                      findings: 3,
                      analyst: 'Sarah Chen'
                    },
                    {
                      id: 'hunt-002', 
                      name: 'Lateral Movement Detection',
                      status: 'In Progress',
                      priority: 'Critical',
                      progress: 45,
                      lastActivity: '15 minutes ago',
                      findings: 7,
                      analyst: 'Mike Torres'
                    },
                    {
                      id: 'hunt-003',
                      name: 'Suspicious PowerShell Activity',
                      status: 'Completed',
                      priority: 'Medium',
                      progress: 100,
                      lastActivity: '1 hour ago',
                      findings: 2,
                      analyst: 'Alex Kim'
                    }
                  ].map((hunt, index) => (
                    <div key={index} className="bg-gray-800/50 rounded-lg border border-gray-700 p-6">
                      <div className="flex items-start justify-between mb-4">
                        <div>
                          <h3 className="text-lg font-semibold text-white mb-1">{hunt.name}</h3>
                          <div className="flex items-center space-x-4 text-sm">
                            <span className={`px-2 py-1 rounded ${
                              hunt.status === 'In Progress' ? 'bg-blue-600/20 text-blue-300' : 'bg-green-600/20 text-green-300'
                            }`}>
                              {hunt.status}
                            </span>
                            <span className={`px-2 py-1 rounded ${
                              hunt.priority === 'Critical' ? 'bg-red-600/20 text-red-300' :
                              hunt.priority === 'High' ? 'bg-orange-600/20 text-orange-300' :
                              'bg-yellow-600/20 text-yellow-300'
                            }`}>
                              {hunt.priority}
                            </span>
                          </div>
                        </div>
                        <button className="p-2 hover:bg-gray-700 rounded transition-colors">
                          <Settings className="w-5 h-5 text-gray-400" />
                        </button>
                      </div>

                      <div className="mb-4">
                        <div className="flex justify-between text-sm mb-2">
                          <span className="text-gray-400">Progress</span>
                          <span className="text-gray-400">{hunt.progress}%</span>
                        </div>
                        <div className="w-full bg-gray-700 rounded-full h-2">
                          <div 
                            className="bg-gradient-to-r from-cyan-500 to-blue-500 h-2 rounded-full transition-all duration-300" 
                            style={{ width: `${hunt.progress}%` }}
                          ></div>
                        </div>
                      </div>

                      <div className="grid grid-cols-3 gap-4 mb-4">
                        <div className="text-center">
                          <div className="text-2xl font-bold text-white">{hunt.findings}</div>
                          <div className="text-xs text-gray-400">Findings</div>
                        </div>
                        <div className="text-center">
                          <div className="text-2xl font-bold text-cyan-400">{Math.floor(Math.random() * 50) + 10}</div>
                          <div className="text-xs text-gray-400">Queries Run</div>
                        </div>
                        <div className="text-center">
                          <div className="text-2xl font-bold text-green-400">{Math.floor(Math.random() * 1000) + 500}</div>
                          <div className="text-xs text-gray-400">Events Analyzed</div>
                        </div>
                      </div>

                      <div className="flex items-center justify-between text-sm">
                        <div className="text-gray-400">
                          <span className="text-white font-medium">{hunt.analyst}</span> • {hunt.lastActivity}
                        </div>
                        <button 
                          onClick={() => {
                            const notification = {
                              id: Date.now(),
                              message: `Opening hunt details for ${hunt.name}`,
                              type: 'success'
                            };
                            setNotifications(prev => [notification, ...prev.slice(0, 4)]);
                          }}
                          className="px-3 py-1 bg-cyan-600 text-white rounded hover:bg-cyan-700 transition-colors"
                        >
                          View Details
                        </button>
                      </div>
                    </div>
                  ))}
                </div>

                {/* Hunt Controls */}
                <div className="space-y-4">
                  <div className="bg-gray-800/50 rounded-lg border border-gray-700 p-4">
                    <h3 className="text-lg font-semibold text-white mb-4">Quick Actions</h3>
                    <div className="space-y-3">
                      <button 
                        onClick={() => {
                          const notification = {
                            id: Date.now(),
                            message: 'Starting new hunt operation...',
                            type: 'success'
                          };
                          setNotifications(prev => [notification, ...prev.slice(0, 4)]);
                        }}
                        className="w-full p-3 bg-cyan-600 text-white rounded-lg hover:bg-cyan-700 transition-colors"
                      >
                        <div className="flex items-center space-x-2">
                          <Target className="w-5 h-5" />
                          <span>Start New Hunt</span>
                        </div>
                      </button>
                      <button className="w-full p-3 bg-gray-700 text-white rounded-lg hover:bg-gray-600 transition-colors">
                        <div className="flex items-center space-x-2">
                          <Radar className="w-5 h-5" />
                          <span>Auto-Hunt Mode</span>
                        </div>
                      </button>
                      <button className="w-full p-3 bg-gray-700 text-white rounded-lg hover:bg-gray-600 transition-colors">
                        <div className="flex items-center space-x-2">
                          <FileText className="w-5 h-5" />
                          <span>Generate Report</span>
                        </div>
                      </button>
                    </div>
                  </div>

                  <div className="bg-gray-800/50 rounded-lg border border-gray-700 p-4">
                    <h3 className="text-lg font-semibold text-white mb-4">Hunt Metrics</h3>
                    <div className="space-y-3">
                      <div className="flex justify-between">
                        <span className="text-gray-400">Active Hunts</span>
                        <span className="text-white font-medium">3</span>
                      </div>
                      <div className="flex justify-between">
                        <span className="text-gray-400">Total Findings</span>
                        <span className="text-cyan-400 font-medium">12</span>
                      </div>
                      <div className="flex justify-between">
                        <span className="text-gray-400">False Positives</span>
                        <span className="text-yellow-400 font-medium">2</span>
                      </div>
                      <div className="flex justify-between">
                        <span className="text-gray-400">Success Rate</span>
                        <span className="text-green-400 font-medium">85%</span>
                      </div>
                    </div>
                  </div>

                  <div className="bg-gray-800/50 rounded-lg border border-gray-700 p-4">
                    <h3 className="text-lg font-semibold text-white mb-4">Recent Alerts</h3>
                    <div className="space-y-2">
                      {[
                        { time: '2m ago', alert: 'Suspicious process creation', severity: 'High' },
                        { time: '5m ago', alert: 'Unusual network traffic', severity: 'Medium' },
                        { time: '8m ago', alert: 'Failed authentication spike', severity: 'High' },
                        { time: '12m ago', alert: 'Registry modification', severity: 'Low' }
                      ].map((alert, index) => (
                        <div key={index} className="p-2 bg-gray-900/50 rounded text-sm">
                          <div className="flex items-center justify-between">
                            <span className="text-white">{alert.alert}</span>
                            <span className={`text-xs ${
                              alert.severity === 'High' ? 'text-orange-400' :
                              alert.severity === 'Medium' ? 'text-yellow-400' :
                              'text-gray-400'
                            }`}>
                              {alert.severity}
                            </span>
                          </div>
                          <div className="text-gray-400 text-xs">{alert.time}</div>
                        </div>
                      ))}
                    </div>
                  </div>
                </div>
              </div>
            </div>
          )}
        </main>
      </div>

      {/* Query Execution Modal */}
      {isExecuting && (
        <div className="fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50">
          <div className="bg-gray-800 rounded-lg border border-gray-700 p-6 max-w-md w-full mx-4">
            <div className="text-center">
              <div className="w-16 h-16 border-4 border-cyan-500 border-t-transparent rounded-full animate-spin mx-auto mb-4"></div>
              <h3 className="text-lg font-semibold text-white mb-2">Executing Query</h3>
              <p className="text-gray-400">Analyzing security events and generating results...</p>
              <div className="mt-4 bg-gray-900/50 rounded p-3">
                <div className="text-sm text-gray-300 font-mono">
                  {activeQuery.slice(0, 100)}...
                </div>
              </div>
            </div>
          </div>
        </div>
      )}

      {/* Footer */}
      <footer className="bg-gray-800/50 backdrop-blur-sm border-t border-cyan-500/30 px-6 py-4">
        <div className="flex items-center justify-between text-sm">
          <div className="flex items-center space-x-4 text-gray-400">
            <span>© 2025 Elite Threat Hunter Platform</span>
            <span>•</span>
            <span>Last updated: {new Date().toLocaleString()}</span>
          </div>
          <div className="flex items-center space-x-4">
            <div className="flex items-center space-x-2">
              <div className="w-2 h-2 bg-green-400 rounded-full"></div>
              <span className="text-gray-400">All systems operational</span>
            </div>
            <button className="text-cyan-400 hover:text-cyan-300 transition-colors">
              System Status
            </button>
          </div>
        </div>
      </footer>
    </div>
  );
};

export default EliteHuntingPlatform;] ? 
                                <ChevronDown className="w-5 h-5 text-gray-400" /> : 
                                <ChevronRight className="w-5 h-5 text-gray-400" />
                              }
                            </button>
                          </div>

                          <p className="text-gray-300 mb-4">{threat.description}</p>

                          {/* TTPs */}
                          <div className="mb-4">
                            <h4 className="text-sm font-semibold text-cyan-400 mb-2">MITRE ATT&CK TTPs</h4>
                            <div className="flex flex-wrap gap-2">
                              {threat.ttps.map((ttp, ttpIndex) => (
                                <button
                                  key={ttpIndex}
                                  onClick={() => window.open(`https://attack.mitre.org/techniques/${ttp.replace('.', '/')}/`, '_blank')}
                                  className="px-2 py-1 bg-blue-600/20 text-blue-300 rounded text-sm hover:bg-blue-600/30 transition-colors"
                                >
                                  {ttp}
                                </button>
                              ))}
                            </div>
                          </div>

                          {/* Indicators */}
                          <div className="mb-4">
                            <h4 className="text-sm font-semibold text-cyan-400 mb-2">Key Indicators</h4>
                            <div className="flex flex-wrap gap-2">
                              {threat.indicators.map((indicator, indicatorIndex) => (
                                <span
                                  key={indicatorIndex}
                                  className="px-2 py-1 bg-gray-700/50 text-gray-300 rounded text-sm"
                                >
                                  {indicator}
                                </span>
                              ))}
                            </div>
                          </div>

                          {/* Resources */}
                          <div className="mb-4">
                            <h4 className="text-sm font-semibold text-cyan-400 mb-2">Resources</h4>
                            <div className="grid grid-cols-1 md:grid-cols-3 gap-2">
                              {threat.resources.map((resource, resourceIndex) => (
                                <button
                                  key={resourceIndex}
                                  onClick={() => {
                                    window.open(resource.url, '_blank');
                                    const notification = {
                                      id: Date.now(),
                                      message: `Opening ${resource.title}`,
                                      type: 'success'
                                    };
                                    setNotifications(prev => [notification, ...prev.slice(0, 4)]);
                                  }}
                                  className="p-2 bg-gray-700/50 rounded-lg hover:bg-gray-700 transition-colors text-left"
                                >
                                  <div className="text-sm font-medium text-white">{resource.type}</div>
                                  <div className="text-xs text-gray-400">{resource.title}</div>
                                </button>
                              ))}
                            </div>
                          </div>

                          {expandedSections[`threat-${index}`
